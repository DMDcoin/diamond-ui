import{u as b,f,b as N,d as A,a as P,r as c,j as t,B as d,g as k}from"./index-en87ZZnQ.js";import{N as q}from"./index-Cq5ZB-Us.js";import{J as m,d as y,S as D,U as T}from"./index-DU_CEnDr.js";const B="_detailsSectionContainer_zqp7q_1",V="_infoContainer_zqp7q_18",w="_statsContainer_zqp7q_37",z="_delegatorStatsContainer_zqp7q_47",E="_daoParticipationContainer_zqp7q_68",F="_styledTable_zqp7q_78",M="_tableBodyRow_zqp7q_108",R="_poolActive_zqp7q_113",U="_poolBanned_zqp7q_117",i={detailsSectionContainer:B,infoContainer:V,statsContainer:w,delegatorStatsContainer:z,daoParticipationContainer:E,styledTable:F,tableBodyRow:M,poolActive:R,poolBanned:U},Y=({})=>{const u=b(),{poolAddress:o}=f(),{userWallet:l}=N(),{activeProposals:C,getMyVote:x,getStateString:W}=A(),{pools:h,stakingEpoch:g,claimOrderedUnstake:_}=P(),[e,p]=c.useState(null),[j,v]=c.useState([]);c.useEffect(()=>{const s=h.find(n=>n.stakingAddress===o);p(s),S()},[o,h,l.myAddr]);async function S(){const n=(await Promise.all(C.map(async a=>{if(a.proposer===o&&a.state=="0"){const r=await x(a.id);return{...a,myVote:r.vote}}else if(a.state=="2"){const r=await x(a.id);if(r&&r.vote!="0")return{...a,myVote:r.vote}}return null}))).filter(a=>a!==null);v(n||[])}return t.jsx("section",{className:"section",children:t.jsxs("div",{className:i.detailsSectionContainer+" sectionContainer",children:[t.jsx(q,{start:"/staking"}),t.jsxs("div",{className:i.infoContainer,children:[t.jsx(m,{diameter:40,seed:y.jsNumberForAddress((e==null?void 0:e.stakingAddress)||"")}),t.jsx("p",{children:o}),t.jsx("p",{className:e!=null&&e.isCurrentValidator||e!=null&&e.isActive?i.poolActive:i.poolBanned,children:e!=null&&e.isCurrentValidator?"Active":e!=null&&e.isActive?"Valid":"Invalid"})]}),t.jsxs("div",{className:i.statsContainer,children:[t.jsx("h1",{children:"Statistics"}),t.jsxs("table",{className:i.styledTable,children:[t.jsx("thead",{}),t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{children:"Total Stake"}),t.jsxs("td",{children:[e?d(e.totalStake).dividedBy(10**18).toFixed(2):0," DMD"]})]}),t.jsxs("tr",{children:[t.jsx("td",{children:"Candidate Stake"}),t.jsxs("td",{children:[e?d(e.ownStake).dividedBy(10**18).toFixed(2):0," DMD"]})]}),t.jsxs("tr",{children:[t.jsx("td",{children:"Score"}),t.jsx("td",{children:e?e.score:0})]}),t.jsxs("tr",{children:[t.jsx("td",{children:"Voting Power"}),t.jsxs("td",{children:[e?e.votingPower.toString():0," %"]})]})]})]})]}),t.jsxs("div",{className:i.delegatorStatsContainer,children:[t.jsxs("div",{children:[t.jsx("h1",{children:"Delegates"}),(e==null?void 0:e.isActive)&&l.myAddr&&t.jsx(D,{buttonText:"Stake",pool:e}),e&&d(e.orderedWithdrawAmount).isGreaterThan(0)&&d(e.orderedWithdrawUnlockEpoch).isLessThanOrEqualTo(g)&&l.myAddr?t.jsx("button",{className:"primaryBtn",onClick:()=>_(e),children:"Claim"}):e&&d(e.myStake).isGreaterThan(0)&&l.myAddr&&t.jsx(T,{buttonText:"Unstake",pool:e})]}),t.jsxs("table",{className:i.styledTable,children:[t.jsx("thead",{children:e&&e.delegators.length?t.jsxs("tr",{children:[t.jsx("td",{}),t.jsx("td",{children:"Wallet"}),t.jsx("td",{children:"Delegated Stake"})]}):t.jsx("tr",{children:t.jsx("td",{children:"No Delegations"})})}),t.jsx("tbody",{children:e&&e.delegators.length?e.delegators.map((s,n)=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx(m,{diameter:40,seed:y.jsNumberForAddress(s.address)})}),t.jsx("td",{children:s.address}),t.jsxs("td",{children:[d(s.amount).dividedBy(10**18).toFixed(2)," DMD"]})]},n)):t.jsx("tr",{})})]})]}),t.jsxs("div",{className:i.daoParticipationContainer,children:[t.jsx("h1",{children:"Validator Candidate DAO Participation"}),t.jsxs("table",{className:i.styledTable,children:[t.jsx("thead",{children:j.length?t.jsxs("tr",{children:[t.jsx("td",{children:"Date"}),t.jsx("td",{children:"Proposal title"}),t.jsx("td",{children:"Proposal type"}),t.jsx("td",{children:"Voting Result"}),t.jsx("td",{})]}):t.jsx("tr",{children:t.jsx("td",{children:"No DAO Participations"})})}),t.jsx("tbody",{children:j.map((s,n)=>t.jsxs("tr",{children:[t.jsx("td",{children:k(s.timestamp)}),t.jsx("td",{children:s.title}),t.jsx("td",{children:s.proposalType}),t.jsx("td",{children:s.myVote=="2"?"Yes":s.myVote=="1"?"No":"Yes"}),t.jsx("td",{children:t.jsx("button",{onClick:()=>c.startTransition(()=>{u(`/dao/details/${s.id}`)}),className:"primaryBtn",children:"Details"})})]},n))})]})]})]})})};export{Y as default};
